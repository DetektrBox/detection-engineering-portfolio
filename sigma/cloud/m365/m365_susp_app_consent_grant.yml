title: Suspicious OAuth App Consent Grant in Microsoft 365
id: c76d4551-6a7f-49f8-b404-511a7775147d
status: stable
description: >
  Detects when a user or attacker grants OAuth application permissions
  (App Consent Grant) that allow access to mail, files, contacts, or other
  sensitive data. Common during BEC, token theft, and consent phishing attacks.

author: Christopher Bradford
date: 2025-11-23

tags:
  - attack.initial-access
  - attack.t1078.004
  - attack.credential-access
  - attack.t1550.001
  - detection.m365

logsource:
  product: azure
  service: auditlogs

detection:
  selection:
    OperationName: "Add OAuth2PermissionGrant"
  selection_high_priv:
    Properties|contains|all:
      - "Mail.Read"
      - "offline_access"

  selection_sensitive:
    Properties|contains:
      - "Files.ReadWrite"
      - "Calendars.ReadWrite"
      - "Mail.ReadWrite"

  condition: selection and (selection_high_priv or selection_sensitive)

falsepositives:
  - Security team-approved OAuth apps
  - Known enterprise applications

level: high
